# =============================================================================
# Ivan Configuration
# =============================================================================
# Copy this file to .env and customize as needed.
# All settings have sensible defaults - only set what you need to change.

# -----------------------------------------------------------------------------
# Backend Configuration
# -----------------------------------------------------------------------------
# Which LLM backend to use: "ollama" or "lmstudio"
IVAN_BACKEND=lmstudio

# Model name for the backend
BACKEND_MODEL=openai/gpt-oss-20b

# Backend endpoints
OLLAMA_ENDPOINT=http://localhost:11434
LMSTUDIO_ENDPOINT=http://localhost:1234/v1

# Ollama Search API key (optional - enables better web search)
# Get your API key from https://ollama.com/settings/keys
# If not set, web search falls back to DuckDuckGo (rate-limited)
# OLLAMA_API_KEY=your_api_key_here

# -----------------------------------------------------------------------------
# Server Settings
# -----------------------------------------------------------------------------
# Port for Ivan API server
IVAN_PORT=8000

# Default temperature for LLM responses (0.0 = deterministic)
IVAN_TEMPERATURE=0.0

# Path to system prompt file
SYSTEM_PROMPT_PATH=system_prompt.md

# Model name advertised via API
IVAN_MODEL_NAME=wwtfo/ivan

# -----------------------------------------------------------------------------
# WebUI Settings
# -----------------------------------------------------------------------------
# Port for Open Web UI
WEBUI_PORT=8001

# Require authentication for WebUI
WEBUI_AUTH=false

# Default prompt suggestions shown on landing page
# Format: JSON array of {"title": ["Part 1", "Part 2"], "content": "prompt text"}
DEFAULT_PROMPT_SUGGESTIONS=[{"title": ["Help me with my", "SE Weekly Update"], "content": "Help me update my SE Weekly notes for [Customer Name]. Check my customer notes for recent activity."}, {"title": ["Draft a follow-up email", "for a customer meeting"], "content": "Help me draft a follow-up email after my meeting with [Customer Name]. Check my notes for context."}, {"title": ["Answer a technical question", "about HashiCorp products"], "content": "What is the recommended approach for [technical topic] with [Terraform/Vault/Consul/Nomad/Boundary]?"}, {"title": ["Help me complete a", "WARMER assessment"], "content": "Help me complete a WARMER assessment for [Customer Name]. Check my customer notes for discovery and meeting context."}]

# -----------------------------------------------------------------------------
# Customer Notes Settings
# -----------------------------------------------------------------------------
# Path to customer meeting notes directory
# Expected structure: Customer_Notes/[A-Z]/[Customer]/10_Meetings/*.md
CUSTOMER_NOTES_DIR=Customer_Notes

# -----------------------------------------------------------------------------
# RAG (Documentation Search) Settings
# -----------------------------------------------------------------------------
# Enable/disable HashiCorp documentation search
RAG_ENABLED=true

# Directory to cache the search index
RAG_CACHE_DIR=hashicorp_docs_index

# How often to check for documentation updates (hours)
RAG_UPDATE_INTERVAL_HOURS=168

# Documentation sources (comma-separated URLs)
RAG_DOC_SOURCES=https://developer.hashicorp.com

# Additional manual URLs to index (comma-separated)
# These are fetched directly in addition to crawled content
# Useful for pages not discovered by the crawler (e.g., validated designs)
RAG_MANUAL_URLS=https://developer.hashicorp.com/validated-designs/boundary-operating-guides-adoption,https://developer.hashicorp.com/validated-designs/boundary-operating-guides-standardization,https://developer.hashicorp.com/validated-designs/boundary-solution-design-guides-boundary-enterprise,https://developer.hashicorp.com/validated-designs/consul-operating-guides-adoption,https://developer.hashicorp.com/validated-designs/consul-operating-guides-scaling,https://developer.hashicorp.com/validated-designs/consul-operating-guides-standardization,https://developer.hashicorp.com/validated-designs/consul-solution-design-guides-consul-enterprise-self-hosted,https://developer.hashicorp.com/validated-designs/nomad-operating-guides-nomad-enterprise,https://developer.hashicorp.com/validated-designs/nomad-solution-design-guides-nomad-enterprise,https://developer.hashicorp.com/validated-designs/terraform-operating-guides-adoption,https://developer.hashicorp.com/validated-designs/terraform-operating-guides-scaling,https://developer.hashicorp.com/validated-designs/terraform-operating-guides-standardization,https://developer.hashicorp.com/validated-designs/terraform-solution-design-guides-terraform-enterprise,https://developer.hashicorp.com/validated-designs/vault-operating-guides-adoption,https://developer.hashicorp.com/validated-designs/vault-operating-guides-scaling,https://developer.hashicorp.com/validated-designs/vault-operating-guides-standardization,https://developer.hashicorp.com/validated-designs/vault-solution-design-guides-vault-enterprise,https://developer.hashicorp.com/validated-designs/vault-radar-operating-guides-hcp-vault-radar

# URL patterns to include (comma-separated regex patterns)
# RAG_URL_INCLUDE_PATTERNS=^https://developer\.hashicorp\.com/(terraform|vault|consul|nomad)

# URL patterns to exclude (comma-separated regex patterns)
# RAG_URL_EXCLUDE_PATTERNS=/partials/,/api-docs/,\?

# Search tuning
RAG_BM25_WEIGHT=0.4
RAG_SEMANTIC_WEIGHT=0.6
RAG_TOP_K=5
RAG_RERANK_ENABLED=true

# Crawler settings
RAG_MAX_CRAWL_DEPTH=3
RAG_RATE_LIMIT_DELAY=0.1
RAG_MAX_WORKERS=5
# RAG_MAX_PAGES=1000  # Uncomment to limit number of pages crawled

# -----------------------------------------------------------------------------
# Debug Settings
# -----------------------------------------------------------------------------
# Enable detailed logging of tool calls and responses
# DEBUG_TOOLS=true

# Log file for tool debug output (default: tools_debug.log)
# DEBUG_TOOLS_LOG_FILE=debug_tools.json

# Log format: "text", "json", or "yaml" (default: text)
# DEBUG_LOG_FORMAT=json

# Maximum characters to log from LLM responses (0 = no truncation, default: 1000)
# DEBUG_LOG_MAX_RESPONSE_LENGTH=0

# Maximum log file size in bytes before rotation (default: 10MB)
# DEBUG_LOG_MAX_BYTES=10485760

# Number of backup log files to keep (default: 5)
# DEBUG_LOG_BACKUP_COUNT=5

# Enable full LLM request/response logging (separate from tool debug)
# DEBUG_LLM_REQUESTS=true
# DEBUG_LLM_REQUESTS_FILE=llm_requests.json

# -----------------------------------------------------------------------------
# Tool Loop Settings
# -----------------------------------------------------------------------------
# Maximum tool calling iterations per request (default: 5)
# MAX_TOOL_ITERATIONS=5

# Maximum seconds for entire tool loop, 0 = no timeout (default: 120)
# TOOL_LOOP_TIMEOUT=120

# Tool choice for first iteration: "auto" or "required" (default: auto)
# "required" forces the model to use a tool on the first turn
# FIRST_ITERATION_TOOL_CHOICE=auto
